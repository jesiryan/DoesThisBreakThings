<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
		<title>Dt340a - Group 6</title>
	    <script type="text/javascript" src="js/userPermissions.js"></script>

		<script type="text/javascript" src="js/libs/modernizr-2.5.3.min.js"></script>
		<link rel="stylesheet" type="text/css" href="css/mystyle.css">
			

		<script type="text/javascript">
                var _validFileExtensions = [".xls",];
                
                function Validate(oForm) {
                    var arrInputs = oForm.getElementsByTagName("input");
                    for (var i = 0; i < arrInputs.length; i++) {
                        var oInput = arrInputs[i];
                        if (oInput.type == "file") {
                            var sFileName = oInput.value;
                            if (sFileName.length > 0) {
                                var blnValid = false;
                                for (var j = 0; j < _validFileExtensions.length; j++) {
                                    var sCurExtension = _validFileExtensions[j];
                                    if (sFileName.substr(sFileName.length - sCurExtension.length, sCurExtension.length).toLowerCase() == sCurExtension.toLowerCase()) {
                                        blnValid = true;
                                        goodToGo = true;
                                        showLoadingImage()
                                        break;
                                        
                                        
                                        
                                    }
                                }
                                
                                if (!blnValid) {
                                    alert("Sorry, " + sFileName + " is invalid, allowed extensions are: " + _validFileExtensions.join(", "));
                                    return false;
                                }
                            }
                        }
                    }
                    
                    return true;
                }
		</script>
		<script>
        	var goodToGo = false;
        	function showLoadingImage(){if(goodToGo==true){document.getElementById('loadingImage').style.visibility='visible';}}
        </script>
	
	</head>


    <body onload="administratorCheck()">
        <div id="container">
        
            <div id="heading-container">
            
                <div id="eir-image"> 
                    <img alt="Ericsson" src="http://www.ericsson.com/shared/eipa/images/elogo.png">   
                </div> 
            
                
                <div id="dit-image"> 
                     <img alt="DIT" src="http://www.dit.ie/media/styleimages/dit_crest.gif" width="90px" height="90px">  
                </div> 
               
                
                <h1>Call Investigation Assistant</h1> 
                <h2>Group 6</h2>  
                <h3 id="userType">System Administrator</h3>
				<div class='wrapper'>
					<form class='alignleft' onclick="logout()"><input class='button' type='submit' value='Logout'/></form>				
					<a href='adminMenu.html'><button class='button alignright'>Home Page</button></a>
				</div>           
            </div>
            
            <div id="upload-container" >  
				<form action="rest/admin/upload" method="post" enctype="multipart/form-data" onsubmit="return Validate(this);">
	            	<h3>Please select .xls file to upload:</h3>            
                    <input type="file" name="uploadedFile" size="50" required="required" onchange="requiredSelected()" />
                    <input class='button' type="submit" value="Upload File" onclick="showLoadingImage()"/> 
                </form>
                <div><img alt="Loading" id="loadingImage" style="visibility: hidden" src="images/loading.gif"></div>
            
            
            
				<!-- form action="rest/admin/upload" method="post" enctype="multipart/form-data">
				
				   <p>
					Select a file : <input type="file" name="uploadedFile" size="50" />
				   </p>
				
				   <input type="submit" value="Upload It" />
				</form>
				   
                //<form action="upload" enctype="multipart/form-data" method="post">
                //   <input type="file" name="uploadFile" required="required"  />
                //    <input class='button' type="submit" value="Upload File"/> 
                //    <input class='button' Type="button" VALUE="Back" onClick="history.go(-1);return true;">
                //</form>-->
            </div>
            <div id="upload-container">
				<h3>File Uploaded Successfully</h3>
                <script>
					document.write('The number of valid rows that have been added to the database is ' + getUrlVars()["validCount"]);
				</script>
				<br>
				<script>
					document.write('The number of invalid rows that have not been added to the database is ' + getUrlVars()["invalidCount"]);
				</script>
			</div>
        </div>
        
        <div id="eric-multi">
            <img src="images/ebottomgrad.jpg" >
        </div>
    
    </body>

</html>
